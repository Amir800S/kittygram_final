version: '3'

volumes: 

  pg_data_production: 

  static: 

  media: 

 

services: 

  db: 

    image: postgres:13 

    volumes: 

      - pg_data_production:/var/lib/postgresql/data 

  backend: 

    build: ./backend/ 

    env_file: .env 

    volumes: 

      - static:/backend_static 

      - media:/app/media/ 

  frontend: 

    env_file: .env 

    build: ./frontend/ 

    command: cp -r /app/build/. /static/ 

    volumes: 

      - static:/frontend_static 

  gateway: 

    build: ./nginx/ 

    env_file: .env 

    ports: 

      - 9000:80 

    volumes: 

      - static:/static 
